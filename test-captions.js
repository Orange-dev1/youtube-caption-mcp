import { workingYouTubeClient } from './dist/services/youtube-client-working.js';

async function testCaptionsDownload() {
  console.log('字幕ダウンロードテストを開始...');
  
  try {
    // テスト用の動画ID（ユーザーが提供したもの）
    const videoId = 'xlR4tWmN3iU';
    
    console.log(`動画ID: ${videoId} の字幕をダウンロード中...`);
    
    // 字幕データをダウンロード
    const captions = await workingYouTubeClient.downloadCaptions(videoId, 'ja');
    
    console.log('✅ 字幕ダウンロード成功!');
    console.log(`言語: ${captions.language}`);
    console.log(`セグメント数: ${captions.segments.length}`);
    console.log(`自動生成: ${captions.isAutoGenerated}`);
    
    // 最初の5つのセグメントを表示
    console.log('\n最初の5つのセグメント:');
    captions.segments.slice(0, 5).forEach((segment, index) => {
      console.log(`${index + 1}. [${segment.start.toFixed(1)}s - ${(segment.start + segment.duration).toFixed(1)}s] ${segment.text}`);
    });
    
    return captions;
  } catch (error) {
    console.error('❌ エラーが発生しました:', error.message);
    console.error('詳細:', error);
    throw error;
  }
}

// テスト実行
testCaptionsDownload()
  .then(() => {
    console.log('\n🎉 テスト完了!');
    process.exit(0);
  })
  .catch((error) => {
    console.error('\n💥 テスト失敗:', error.message);
    process.exit(1);
  }); 