import { workingYouTubeClient } from './dist/services/youtube-client-working.js';

async function testCaptionsDownload() {
  console.log('å­—å¹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
  
  try {
    // ãƒ†ã‚¹ãƒˆç”¨ã®å‹•ç”»IDï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæä¾›ã—ãŸã‚‚ã®ï¼‰
    const videoId = 'xlR4tWmN3iU';
    
    console.log(`å‹•ç”»ID: ${videoId} ã®å­—å¹•ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...`);
    
    // å­—å¹•ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    const captions = await workingYouTubeClient.downloadCaptions(videoId, 'ja');
    
    console.log('âœ… å­—å¹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æˆåŠŸ!');
    console.log(`è¨€èªž: ${captions.language}`);
    console.log(`ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°: ${captions.segments.length}`);
    console.log(`è‡ªå‹•ç”Ÿæˆ: ${captions.isAutoGenerated}`);
    
    // æœ€åˆã®5ã¤ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤º
    console.log('\næœ€åˆã®5ã¤ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ:');
    captions.segments.slice(0, 5).forEach((segment, index) => {
      console.log(`${index + 1}. [${segment.start.toFixed(1)}s - ${(segment.start + segment.duration).toFixed(1)}s] ${segment.text}`);
    });
    
    return captions;
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error.message);
    console.error('è©³ç´°:', error);
    throw error;
  }
}

// ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
testCaptionsDownload()
  .then(() => {
    console.log('\nðŸŽ‰ ãƒ†ã‚¹ãƒˆå®Œäº†!');
    process.exit(0);
  })
  .catch((error) => {
    console.error('\nðŸ’¥ ãƒ†ã‚¹ãƒˆå¤±æ•—:', error.message);
    process.exit(1);
  }); 